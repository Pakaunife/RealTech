
<div class="catalogo">
  <h1 [class.vista-prodotti]="mostraProdotti || mostraDettaglio">{{ mostraCategorie ? 'Categorie Prodotti' : (mostraDettaglio ? prodottoSelezionato?.nome : categoriaSelezionata) }}</h1>
  <!-- Vista Categorie -->
  <div *ngIf="mostraCategorie" class="categorie-grid">
    <div class="categoria-card" *ngFor="let categoria of categorie" 
         (click)="selezionaCategoria(categoria.nome)"
         [style.background-image]="categoria.immagine_url ? 'url(' + categoria.immagine_url + ')' : 'url(/assets/default-category.jpg)'">
      <h3>{{ categoria.nome }}</h3>
      <p>Esplora la categoria</p>
    </div>
  </div>
  <!-- Vista Dettaglio -->
  <div *ngIf="mostraDettaglio" class="categorie-grid">
    <div *ngIf="!arrivoDaHome" class="categoria-card" (click)="tornaProdotti()">
      <h3>← Torna ai Prodotti</h3>
      <p>Clicca per tornare alla lista</p>
    </div>
    <div class="dettaglio-card">
      <img [src]="prodottoSelezionato?.immagine_url || 'http://localhost:3000/api/images/prodotti/default.jpg'" 
           [alt]="prodottoSelezionato?.nome"
           class="prodotto-immagine-dettaglio">
      <h2 *ngIf="!arrivoDaHome">{{ prodottoSelezionato?.nome }}</h2>
      <p><strong>Marchio:</strong> {{ prodottoSelezionato?.marchio || 'Non specificato' }}</p>
      <p><strong>Prezzo:</strong> €{{ prodottoSelezionato?.prezzo }}</p>
      <p><strong>Descrizione:</strong> {{ prodottoSelezionato?.descrizione || 'Descrizione non disponibile' }}</p>
      <p *ngIf="!arrivoDaHome"><strong>Disponibilità:</strong> {{ prodottoSelezionato?.quantita_disponibile }} pezzi</p>
      <!-- PULSANTE CARRELLO NEL DETTAGLIO -->
      <button (click)="aggiungiAlCarrello(prodottoSelezionato)" 
              [disabled]="prodottoSelezionato?.quantita_disponibile <= 0">
        {{ prodottoSelezionato?.quantita_disponibile > 0 ? 'Aggiungi al carrello' : 'Non disponibile' }}
      </button>
    </div>
  </div>
  <!-- Vista Prodotti -->
  <div *ngIf="mostraProdotti">
    <div class="prodotti-grid">
      <div class="categoria-card_prodotto" *ngFor="let prodotto of prodottiFiltrati">
        <div (click)="selezionaProdotto(prodotto)">
          <img [src]="prodotto.immagine_url || 'http://localhost:3000/api/images/prodotti/default.jpg'" 
               [alt]="prodotto.nome"
               class="prodotto-immagine">
          <h3>{{ prodotto.nome }}</h3>
          <p>{{ prodotto.marchio || 'Marchio non specificato' }}</p>
          <p style="font-weight: bold;">€{{ prodotto.prezzo }}</p>
          <p>Disponibili: {{ prodotto.quantita_disponibile }}</p>
        </div>
        <!-- PULSANTE CARRELLO -->
        <button (click)="aggiungiAlCarrello(prodotto)" 
                [disabled]="prodotto.quantita_disponibile <= 0">
          {{ prodotto.quantita_disponibile > 0 ? 'Aggiungi al carrello' : 'Non disponibile' }}
        </button>
      </div>
    </div>
  </div>
</div>

