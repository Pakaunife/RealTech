

<div class="carrello">
  <h2 class="carrello-text">Il tuo carrello</h2>
  
  <ng-container *ngIf="carrello$ | async as carrello">
    <div *ngIf="carrello.length === 0" class="carrello-vuoto">
    <p class="carrello-text">Il carrello è vuoto</p>
    <a href="/catalogo">Continua gli acquisti</a>
  </div>
  
    <div *ngFor="let item of carrello; trackBy: trackByItem" class="carrello-item">  <!-- item.nome preso da carrello$ che sta in carrello.ts -->
    <img [src]="item.immagine_url || 'http://localhost:3000/api/images/prodotti/default.jpg'" [alt]="item.nome" width="100">
    <div class="item-details">
      <h4 class="carrello-text">{{ item.nome }}</h4>
      <!-- per prezzo in caso promo fosse true -->
        <p class="carrello-text">Prezzo: €{{ item.prezzo_scontato != null ? item.prezzo_scontato : item.prezzo }}</p>
      <div class="quantity-control">
        <label class="carrello-label">Quantità: </label>
        <input type="number"
               [value]="item.quantita"
               min="1"
               (change)="aggiornaQuantitaItem(item, $event)">
      </div>
  <!-- Subtotale rimosso per evitare duplicati; mostriamo solo il prezzo unitario -->
      <button (click)="rimuoviItem(item)" class="btn-remove">
        Rimuovi
      </button>
    </div>
    </div>

    <div *ngIf="carrello && carrello.length > 0" class="totale">
    <h3 class="carrello-text">Totale: {{ totale }}€</h3>
    <button class="btn-checkout" (click)="procediAlCheckout()">Procedi al checkout</button>
  </div>
  </ng-container>
</div>


